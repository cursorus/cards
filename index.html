<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Locked Cards</title>
<link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">

<style>
body {
  margin: 0;
  height: 100vh;
  background: #0b0b0b;
  color: white;
  font-family: system-ui;
  overflow: hidden;
}

#lock {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.85);
  backdrop-filter: blur(18px);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 10;
}

#dots {
  font-size: 32px;
  letter-spacing: 10px;
  margin-bottom: 20px;
}

.keypad {
  display: grid;
  grid-template-columns: repeat(3, 70px);
  gap: 12px;
}

.keypad button {
  height: 70px;
  border-radius: 50%;
  border: none;
  font-size: 22px;
  background: #1c1c1c;
  color: white;
}

#app {
  display: none;
  height: 100vh;
}

.swiper {
  width: 90%;
  max-width: 900px;
  margin: auto;
  margin-top: 40px;
}

.card {
  width: 260px;
  height: 360px;
  border-radius: 16px;
  overflow: hidden;
}

.card img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

#lockBtn {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  padding: 12px 20px;
  border-radius: 20px;
  border: none;
  background: #222;
  color: white;
}
</style>
</head>
<body>

<!-- LOCK -->
<div id="lock">
  <div id="dots">â—‹ â—‹ â—‹ â—‹</div>
  <div class="keypad" id="keys"></div>
</div>

<!-- APP -->
<div id="app">
  <div class="swiper">
    <div class="swiper-wrapper" id="cards"></div>
  </div>
  <button id="lockBtn">ðŸ”’ Ð—Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ</button>
</div>

<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

<script>
const PIN_HASH = "4225466f46976e5877d0c8f7a77eafbf97a92841dedabae705816fa4c76e033f"; // â† ÑÑŽÐ´Ð° Ð¿Ð¾Ð´ÑÑ‚Ð°Ð²Ð¸Ñ‚ GitHub Actions
let input = "";

const dots = document.getElementById("dots");
const lock = document.getElementById("lock");
const app = document.getElementById("app");

function updateDots() {
  dots.textContent = input.padEnd(4, "â—‹").split("").join(" ");
}

async function sha256(str) {
  const buf = await crypto.subtle.digest("SHA-256", new TextEncoder().encode(str));
  return [...new Uint8Array(buf)].map(b => b.toString(16).padStart(2,"0")).join("");
}

for (let i = 1; i <= 9; i++) addKey(i);
addKey(0);

function addKey(n) {
  const b = document.createElement("button");
  b.textContent = n;
  b.onclick = async () => {
    if (input.length >= 4) return;
    input += n;
    updateDots();

    if (input.length === 4) {
      if (await sha256(input) === PIN_HASH) unlock();
      else {
        input = "";
        updateDots();
      }
    }
  };
  keys.appendChild(b);
}

function unlock() {
  lock.style.display = "none";
  app.style.display = "block";
}

document.getElementById("lockBtn").onclick = () => {
  input = "";
  updateDots();
  app.style.display = "none";
  lock.style.display = "flex";
};

// cards
fetch("images.json").then(r=>r.json()).then(imgs=>{
  const c = document.getElementById("cards");
  imgs.forEach(i=>{
    c.innerHTML += `
      <div class="swiper-slide">
        <div class="card"><img src="images/${i}"></div>
      </div>`;
  });
  new Swiper(".swiper",{loop:true,centeredSlides:true,slidesPerView:1.3});
});
</script>

</body>
</html>
