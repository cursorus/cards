<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover">
<title>Карточки</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
:root {
  --bg:#050505;
  --pill:rgba(20,20,20,.8);
  --accent:#fff;
  --gray:#555;
}

html,body{
  margin:0;
  height:100%;
  background:var(--bg);
  color:#fff;
  font-family:-apple-system,sans-serif;
  overflow:hidden;
}

.flex-center{
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  height:100%;
}

.hidden{display:none!important}

/* AUTH */
#auth-screen{position:fixed;inset:0;z-index:1000;background:var(--bg)}
.pin-dots{display:flex;gap:14px;margin-bottom:35px}
.dot{width:14px;height:14px;border:2px solid #333;border-radius:50%}
.dot.filled{background:#fff;border-color:#fff}
.keypad{display:grid;grid-template-columns:repeat(3,75px);gap:14px}
.key{
  width:75px;height:75px;border-radius:50%;
  background:#111;display:flex;align-items:center;justify-content:center;
  font-size:22px
}

/* SWIPER */
.swiper{width:310px;height:440px}
.swiper-slide{
  border-radius:35px;
  background:#000;
  overflow:hidden;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* FAKE BACKGROUND (NO BLUR) */
.fake-bg{
  position:absolute;
  inset:0;
  object-fit:cover;
  opacity:.35;
  transform:scale(1.15);
  z-index:1;
}

/* IMAGE */
.main-img{
  position:relative;
  z-index:2;
  max-width:100%;
  max-height:100%;
  opacity:0;
  transition:opacity .25s ease-out;
}

.main-img.loaded{opacity:1}
.is-vertical{width:100%;height:100%;object-fit:cover}
.is-horizontal{width:94%;height:auto;border-radius:16px}

/* NAV */
.nav-container{
  position:fixed;
  bottom:30px;
  width:100%;
  display:flex;
  justify-content:center;
  gap:15px;
  z-index:50;
}

.nav-pill{
  background:var(--pill);
  backdrop-filter:blur(18px);
  padding:8px;
  border-radius:40px;
  display:flex;
}

.nav-item{
  background:none;
  border:none;
  color:var(--gray);
  padding:8px 15px;
  border-radius:30px;
}

.nav-item.active{
  color:#fff;
  background:#222;
}

.fab{
  width:70px;height:70px;border-radius:50%;
  background:var(--pill);
  display:flex;
  align-items:center;
  justify-content:center;
}
</style>
</head>

<body>

<div id="auth-screen" class="flex-center">
  <div class="pin-dots">
    <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
  </div>
  <div class="keypad">
    <div class="key" onclick="press(1)">1</div>
    <div class="key" onclick="press(2)">2</div>
    <div class="key" onclick="press(3)">3</div>
    <div class="key" onclick="press(4)">4</div>
    <div class="key" onclick="press(5)">5</div>
    <div class="key" onclick="press(6)">6</div>
    <div class="key" onclick="press(7)">7</div>
    <div class="key" onclick="press(8)">8</div>
    <div class="key" onclick="press(9)">9</div>
    <div></div>
    <div class="key" onclick="press(0)">0</div>
    <div class="key" onclick="press('C')">×</div>
  </div>
</div>

<div id="app-screen" class="hidden flex-center">
  <div class="swiper" id="sw-main">
    <div class="swiper-wrapper" id="w-main"></div>
  </div>
</div>

<div class="nav-container hidden" id="nav">
  <div class="nav-pill">
    <button class="nav-item active">Склад</button>
  </div>
  <div class="fab">
    <span class="material-symbols-rounded">download</span>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

<script>
const PIN_HASH="4225466f46976e5877d0c8f7a77eafbf97a92841dedabae705816fa4c76e033f";
const FILES=["ru_arguments_1767868277325_12.enc","ru_arguments_1767868274034_9.enc","ru_arguments_1767868269647_5.enc","ru_arguments_1767868273062_8.enc","ru_arguments_1767868275164_10.enc","funny_1767871819421_0.enc","ru_arguments_1767868271940_7.enc","ru_arguments_1767868276175_11.enc","ru_arguments_1767868270752_6.enc","ru_arguments_1767868257796_0.enc","ru_arguments_1767868268258_4.enc","ru_arguments_1767868266905_3.enc","ru_arguments_1767868265015_2.enc","ru_arguments_1767868263202_1.enc"];

let pin="",swiper;

function press(n){
  if(n==='C') pin="";
  else if(pin.length<4) pin+=n;

  document.querySelectorAll('.dot').forEach((d,i)=>{
    d.className=i<pin.length?'dot filled':'dot';
  });

  if(pin.length===4){
    setTimeout(()=>{
      if(CryptoJS.SHA256(pin).toString()===PIN_HASH.replace(/['"]/g,'')){
        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('app-screen').classList.remove('hidden');
        document.getElementById('nav').classList.remove('hidden');
        init();
      } else {
        pin="";
        document.querySelectorAll('.dot').forEach(d=>d.className='dot');
      }
    },150);
  }
}

async function decrypt(f){
  const r=await fetch(`images/${f}`);
  const enc=await r.text();
  return CryptoJS.AES.decrypt(enc,pin).toString(CryptoJS.enc.Utf8);
}

function createSlide(src){
  const s=document.createElement('div');
  s.className='swiper-slide';

  const bg=document.createElement('img');
  bg.className='fake-bg';

  const img=document.createElement('img');
  img.className='main-img';

  img.onload=()=>{
    const a=img.naturalHeight/img.naturalWidth;
    img.classList.add(a>1.2?'is-vertical':'is-horizontal');
    img.classList.add('loaded');
    bg.src=img.src;
  };

  img.src=src;
  s.append(bg,img);
  return s;
}

async function init(){
  const w=document.getElementById('w-main');
  for(const f of FILES){
    if(!f.endsWith('.enc')) continue;
    const src=await decrypt(f);
    w.appendChild(createSlide(src));
  }

  swiper=new Swiper('#sw-main',{
    effect:'creative',
    speed:280,
    resistanceRatio:.85,
    creativeEffect:{
      prev:{translate:[0,0,-120],scale:.95},
      next:{translate:[0,'100%',0]}
    }
  });
}
</script>

</body>
</html>
