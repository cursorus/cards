<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Cards</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
<style>
  body { margin: 0; height: 100vh; background: #0f0f0f; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; color: white; }
  
  /* Меню выбора */
  .menu-container { text-align: center; z-index: 10; transition: 0.3s; }
  .hidden { display: none; }
  .btn { background: #141414; color: white; border: none; padding: 10px 20px; margin: 5px; border-radius: 10px; cursor: pointer; font-size: 16px; transition: 0.3s; }
  .btn:hover { background: #141414; }

  /* Слайдер */
  .swiper { width: 320px; height: 420px; margin: 20px 0; }
  .swiper-slide { border-radius: 20px; overflow: hidden; background: #222; box-shadow: 0 20px 40px rgba(0,0,0,.5); }
  .swiper-slide img { width: 100%; height: 100%; object-fit: cover; }

  /* Кнопка скачать */
  .download-btn {
    width: 60px; height: 60px; border-radius: 50%; background: #ff4500;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; border: none; box-shadow: 0 4px 15px rgba(255,69,0,0.4);
    transition: transform 0.2s;
  }
  .download-btn:active { transform: scale(0.9); }
  .download-btn svg { fill: white; width: 30px; height: 30px; }
</style>
</head>
<body>

  <div id="lang-step" class="menu-container"
    <button class="btn" onclick="selectLang('en')">English</button>
    <button class="btn" onclick="selectLang('ru')">Русский</button>
  </div>

  <div id="type-step" class="menu-container hidden">
    <h2 id="type-title"></h2>
    <div id="type-buttons"></div>
    <button class="btn" style="background:none; font-size: 12px;" onclick="location.reload()">← Back</button>
  </div>

  <div id="view-step" class="menu-container hidden">
    <div class="swiper">
      <div class="swiper-wrapper" id="cards"></div>
    </div>
    <button class="download-btn" onclick="downloadCurrent()">
      <svg viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
    </button>
    <br>
    <button class="btn" style="background:none; font-size: 12px;" onclick="location.reload()">← Restart</button>
  </div>

<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
<script>
  // Сюда GitHub вставит данные
  const allImages = __IMAGES_DATA__; 
  const typesMap = __TYPES_JSON__;

  let currentLang = '';
  let currentType = '';
  let swiper;

  function selectLang(lang) {
    currentLang = lang;
    document.getElementById('lang-step').classList.add('hidden');
    const typeStep = document.getElementById('type-step');
    typeStep.classList.remove('hidden');
    
    const title = lang === 'ru' ? 'Выберите категорию' : 'Select Category';
    document.getElementById('type-title').innerText = title;

    const btnContainer = document.getElementById('type-buttons');
    btnContainer.innerHTML = '';

    // Генерируем кнопки категорий из types.json
    for (const [enName, ruName] of Object.entries(typesMap)) {
      const btn = document.createElement('button');
      btn.className = 'btn';
      btn.innerText = lang === 'ru' ? ruName : enName;
      btn.onclick = () => startViewer(enName);
      btnContainer.appendChild(btn);
    }
  }

  function startViewer(type) {
    currentType = type;
    document.getElementById('type-step').classList.add('hidden');
    document.getElementById('view-step').classList.remove('hidden');

    const folderName = `${currentLang}-${currentType}`;
    const images = allImages[folderName] || [];
    const container = document.getElementById('cards');
    container.innerHTML = '';

    images.forEach(img => {
      const slide = document.createElement('div');
      slide.className = 'swiper-slide';
      slide.innerHTML = `<img src="images/${folderName}/${img}">`;
      container.appendChild(slide);
    });

    swiper = new Swiper(".swiper", {
      effect: "cards",
      grabCursor: true
    });
  }

  function downloadCurrent() {
    const activeIndex = swiper.activeIndex;
    const folderName = `${currentLang}-${currentType}`;
    const imageName = allImages[folderName][activeIndex];
    const link = document.createElement('a');
    link.href = `images/${folderName}/${imageName}`;
    link.download = imageName;
    link.click();
  }
</script>
</body>
</html>
